"use strict";"strict";var fe=Object.create;var F=Object.defineProperty;var ge=Object.getOwnPropertyDescriptor;var ye=Object.getOwnPropertyNames;var ke=Object.getPrototypeOf,be=Object.prototype.hasOwnProperty;var p=(t,e)=>F(t,"name",{value:e,configurable:!0});var we=(t,e,s,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of ye(e))!be.call(t,o)&&o!==s&&F(t,o,{get:()=>e[o],enumerable:!(a=ge(e,o))||a.enumerable});return t};var S=(t,e,s)=>(s=t!=null?fe(ke(t)):{},we(e||!t||!t.__esModule?F(s,"default",{value:t,enumerable:!0}):s,t));var u=(t,e,s)=>new Promise((a,o)=>{var i=c=>{try{l(s.next(c))}catch(d){o(d)}},r=c=>{try{l(s.throw(c))}catch(d){o(d)}},l=c=>c.done?a(c.value):Promise.resolve(c.value).then(i,r);l((s=s.apply(t,e)).next())});var re=S(require("fastify")),ne=S(require("@fastify/helmet")),oe=S(require("@fastify/compress")),ie=S(require("@fastify/cors")),le=S(require("@fastify/static")),ce=S(require("path")),g=S(require("cross-fetch")),de=require("@ethereumjs/tx"),ue=require("@theconvospace/sdk"),T=require("@ethersproject/address");require("dotenv").config({path:".env"});var f=p(t=>{let e=process.env[t];if(e===void 0)throw new Error(`'${t}' Environment Variable is Not Defined`);return e},"getEnv"),x=p(t=>JSON.parse(f(t)),"getEnvJson"),W=p((...t)=>{f("DEBUG")==="true"&&console.log(...t)},"debugLog"),U=p(t=>{let s=t.split(" ")[2];if(s.length===10)try{return parseInt(s.slice(0,2))<=16?new Date(parseInt(s+"000")):new Date(parseInt(s.slice(0,4)),parseInt(s.slice(4,6)),parseInt(s.slice(6,8)),0,0,0,0)}catch(a){return!1}else return!1},"parseSerialFromAnswerData");var E=S(require("path")),X=S(require("util")),M=require("fs/promises"),P=require("fs"),O=require("@ethersproject/address"),Z=S(require("cross-fetch"));var G=S(require("util"));var Re=G.default.promisify(require("child_process").exec);function z(t){return u(this,null,function*(){let{stderr:e}=yield Re(`solc-select use ${t}`);return e===""?!0:(console.error(e),!1)})}p(z,"setSolidityVersion");var Q=new Map([["mainnet",`https://api.etherscan.io/api?apikey=${f("ETHERSCAN_API_KEY")}`],["polygon",`https://api.polygonscan.com/api?apikey=${f("POLYGONSCAN_API_KEY")}`],["polygon-testnet",`https://api-testnet.polygonscan.com/api?apikey=${f("POLYGONSCAN_API_KEY")}`]]);var Se=X.default.promisify(require("child_process").exec);function Ae(t,e,s){return u(this,null,function*(){var c;let a=E.default.join(__dirname,"../contracts");(0,P.existsSync)(a)||(0,P.mkdirSync)(a);let o=t+"-"+(0,O.getAddress)(e);yield(0,M.writeFile)(E.default.join(a,o+".sol"),s);let i=`slither ${E.default.join(a,o+".sol")} --json ${E.default.join(a,o+".json")} --exclude-low --exclude-medium --exclude-informational --exclude-optimization --solc-disable-warnings`;try{let{stdout:d,stderr:h}=yield Se(i)}catch(d){}let r=yield(0,M.readFile)(E.default.join(a,o+".json"),{encoding:"utf8"}),l=JSON.parse(r.toString());return l.success===!0&&((c=l.results)==null?void 0:c.detectors)!=null&&l.results.detectors.length>0?(console.log("storeAndRun/foundIssue"),{foundIssue:!0,data:l.results.detectors}):(console.log("storeAndRun/Nothing Found"),{foundIssue:!1,data:[]})})}p(Ae,"storeAndRun");function B(t,e){return u(this,null,function*(){var o;let s=t+"-"+(0,O.getAddress)(e),a=E.default.join(__dirname,"../contracts",s+".json");if((0,P.existsSync)(a)){let i=yield(0,M.readFile)(a,{encoding:"utf8"}),r=JSON.parse(i.toString());return r.success===!0&&((o=r.results)==null?void 0:o.detectors)!=null&&r.results.detectors.length>0?{cached:!0,success:!0,results:r.results.detectors,error:""}:{cached:!0,success:!0,results:[],error:""}}else{let i=yield(0,Z.default)(`${Q.get(t)}&module=contract&action=getsourcecode&address=${e}`);if(i.ok===!0){let r=yield i.json();if(r.status=="1"&&r.result.length>0)if(r.result[0].Proxy==="0"){let l=r.result[0].SourceCode,c=r.result[0].CompilerVersion.split("+")[0].slice(1),d=yield z(c);if(console.log("setVersionResp",c,d),d===!0){let h=yield Ae(t,e,l);return h.foundIssue?{success:!0,results:h.data,error:""}:{success:!0,results:[],error:""}}else return console.log("Failed to set Solidity Version."),{success:!1,error:"Failed to set Solidity Version.",results:[]}}else return{success:!1,error:"Proxy",results:[]};else return console.log("Source code not verified on EtherScan"),{success:!1,error:"Source code not verified on EtherScan",results:[]}}else return console.log("Error Fetching Source Code from EtherScan"),{success:!1,error:"Error Fetching Source Code from EtherScan",results:[]}}})}p(B,"testUsingSlither");var N=require("fastest-levenshtein"),pe=require("socks-proxy-agent"),he=S(require("util"));var q={1:{id:"409H/EtherAddressLookup",name:"EtherAddressLookup",link:"https://github.com/409H/EtherAddressLookup"},2:{id:"MetaMask/eth-phishing-detect",name:"EthPhishingDetector",link:"https://github.com/MetaMask/eth-phishing-detect"},3:{id:"MyEtherWallet/ethereum-lists",name:"MyEtherWallet",link:"https://github.com/MyEtherWallet/ethereum-lists"},4:{id:"DAOBuidler/MetaShieldExtension",name:"MetaShield",link:"https://www.metashield.cc/indexen.html"},5:{id:"cryptoscamdb",name:"CryptoScamDB",link:"https://cryptoscamdb.org/"},6:{id:"walletguard",name:"Wallet Guard",link:"https://walletguard.app/"},7:{id:"anudit/chainabuse",name:"Chainabuse",link:"https://www.chainabuse.com/"},8:{id:"mitchellkrogza/Phishing.Database",name:"Phishing Domain Database",link:"https://github.com/mitchellkrogza/Phishing.Database"},9:{id:"phish.sinking.yachts",name:"SinkingYachts",link:"https://phish.sinking.yachts/"},10:{id:"stamparm/aux",name:"stamparm/aux",link:"https://github.com/stamparm/aux"},11:{id:"scamsniffer/scam-database",name:"ScamSniffer",link:"https://scamsniffer.io/"},12:{id:"phishfort/phishfort-lists",name:"PhishFort",link:"https://www.phishfort.com/"},13:{id:"blueshell-io/scamdb",name:"BlueShell",link:"https://blueshell.io/"}};var L=S(require("cross-fetch"));function Ee(){return u(this,null,function*(){console.log("Compiling tokenlists");let t={1:"https://account.metafi.codefi.network/networks/1/tokens",10:"https://account.metafi.codefi.network/networks/10/tokens",137:"https://account.metafi.codefi.network/networks/137/tokens",51:"https://account.metafi.codefi.network/networks/56/tokens",43114:"https://account.metafi.codefi.network/networks/43114/tokens",42161:"https://account.metafi.codefi.network/networks/42161/tokens",250:"https://account.metafi.codefi.network/networks/250/tokens"},e=Object.keys(t).map(r=>(0,L.default)(t[r]).then(l=>l.json())),s=yield Promise.allSettled(e),a=[];for(let r=0;r<s.length;r++){let l=s[r];l.status=="fulfilled"&&(a=a.concat(l.value))}a.push({name:"Matic",symbol:"MATIC",decimals:18,address:"0x0000000000000000000000000000000000001010",iconUrl:"https://tokens.1inch.io/0x7d1afa7b718fb893db30a3abc0cfc608aacfebb0.png",sources:["https://wiki.polygon.technology/docs/faq/wallet-bridge-faq/#why-is-the-matic-token-is-not-supported-on-pos"],chainId:137,coingeckoId:"matic-network"});let o=yield(0,L.default)("https://raw.githubusercontent.com/MetaMask/contract-metadata/master/contract-map.json").then(r=>r.json());for(let[r,l]of Object.entries(o))a.push({name:l.name,symbol:l.symbol,decimals:l.decimals,address:r,iconUrl:"https://raw.githubusercontent.com/MetaMask/contract-metadata/master/images/"+l.logo,sources:["https://github.com/MetaMask/contract-metadata"],chainId:1});let i=yield(0,L.default)("https://raw.githubusercontent.com/ethereum-optimism/ethereum-optimism.github.io/master/optimism.tokenlist.json").then(r=>r.json());for(let r=0;r<i.tokens.length;r++){let l=i.tokens[r];a.push({name:l.name,symbol:l.symbol,decimals:l.decimals,address:l.address,iconUrl:l.logoURI,sources:["https://github.com/ethereum-optimism/ethereum-optimism.github.io/tree/master"],chainId:l.chainId})}return console.log("\u{1FA99} ",a.length,"Tokens"),a})}p(Ee,"getTokenLists");var ee=Ee;var $=require("@upstash/ratelimit"),te=require("@upstash/redis");var _e=new $.Ratelimit({redis:new te.Redis({url:f("RATELIMIT_UPSTASH_REDIS_REST_URL"),token:f("RATELIMIT_UPSTASH_REDIS_REST_TOKEN")}),limiter:$.Ratelimit.slidingWindow(100,"10 s"),timeout:1e3,analytics:!0}),se=_e;var k=(0,re.default)({logger:!1}),Ie=require("ethereumjs-util").toBuffer,Te=require("eth-phishing-detect"),Ce=he.default.promisify(require("child_process").exec);k.register(ne.default,{global:!0});k.register(oe.default,{global:!0});k.register(ie.default,{origin:"*"});k.register(le.default,{root:ce.default.join(__dirname,"../public")});var Me=require("megahash"),m=new Me,I=new Set,Pe=`https://api.tenderly.co/api/v1/account/${f("TENDERLY_USER")}/project/${f("TENDERLY_PROJECT")}/simulate`,je="socks5://0.0.0.0:9150",A=[],Le=f("RATELIMIT_ENABLED")==="true",De=new ue.Convo(f("CONVO_API_KEY")),Ne={alchemyApiKey:f("ALCHEMY_API_KEY"),CNVSEC_ID:f("CNVSEC_ID"),etherscanApiKey:f("ETHERSCAN_API_KEY"),polygonscanApiKey:f("POLYGONSCAN_API_KEY"),optimismscanApiKey:f("OPTIMISMSCAN_API_KEY"),polygonMainnetRpc:"",etherumMainnetRpc:"",avalancheMainnetRpc:"",maticPriceInUsd:0,etherumPriceInUsd:0,deepdaoApiKey:"",zapperApiKey:"",DEBUG:!1},D=new Map([["mainnet","MAINNET_RPC_URL"],["mainnet-flashbots","MAINNET_FLASHBOTS_RPC_URL"],["mainnet-flashbots-fast","MAINNET_FLASHBOTS_FAST_RPC_URL"],["goerli","GOERLI_RPC_URL"],["sepolia","SEPOLIA_RPC_URL"],["goerli-flashbots","GOERLI_FLASHBOTS_RPC_URL"],["polygon","POLYGON_RPC_URL"],["polygon-testnet","POLYGON_TESTNET_RPC_URL"],["polygon-zkevm","POLYGON_ZKEVM_RPC_URL"],["optimism","OPTIMISM_RPC_URL"],["optimism-testnet","OPTIMISM_TESTNET_RPC_URL"],["arbitrum","ARBITRUM_RPC_URL"],["arbitrum-nova","ARBITRUM_NOVA_RPC_URL"],["arbitrum-testnet","ARBITRUM_TESTNET_RPC_URL"],["bsc","BSC_RPC_URL"],["bsc-testnet","BSC_TESTNET_RPC_URL"],["fantom","FANTOM_RPC_URL"],["fantom-testnet","FANTOM_TESTNET_RPC_URL"],["base-testnet","BASE_TESTNET_RPC_URL"]]),ve=p(t=>{let e=D.get(t);if(e){let s=x(e);return s[Math.floor(Math.random()*s.length)]}else return""},"networkToRpc");function w(t,e=void 0){return{isMalicious:!0,rpcResp:{id:420,jsonrpc:"2.0",error:{code:-32003,message:t}},details:e}}p(w,"getMalRpcError");function V(t){return u(this,null,function*(){try{if((0,T.isAddress)(t)){let e=yield De.omnid.kits.isMalicious((0,T.getAddress)(t),Ne);return console.log("omnid.kits.isMalicious",(0,T.getAddress)(t),e),e!=null&&e.alchemy&&e.alchemy===!0?w("Spam Contract Flagged by Alchemy",e):e!=null&&e.chainabuse&&e.chainabuse?w("Contract Flagged by Chainabuse",e):e!=null&&e.scanblocks&&e.scanblocks===!0?w("Address Flagged by Scanblocks",e):e!=null&&e.cryptoscamdb&&e.cryptoscamdb===!0?w("Contract Flagged by CryptoscamDB",e):e!=null&&e.etherscan&&"label"in e.etherscan?w(`Address Flagged as ${e.etherscan.label} by Etherscan`,e):e!=null&&e.mew&&"comment"in e.mew?w("Address Flagged by MyEtherWallet",e):e!=null&&e.sdn?w("Address Flagged by OFAC",e):e!=null&&e.tokenblacklist?w("Address Blacklisted by Stablecoin",e):e!=null&&e.txn?w("Address/Contract Funded by Tornado Cash.",e):{isMalicious:!1}}else return{isMalicious:!1}}catch(e){return{isMalicious:!1}}})}p(V,"checkAddress");function Fe(t){return u(this,null,function*(){try{return yield(0,g.default)(Pe,{method:"POST",body:JSON.stringify(t),headers:{"X-Access-Key":f("TENDERLY_ACCESS_KEY")}}).then(s=>s.json())}catch(e){return console.log("alchemySimulate",e),!1}})}p(Fe,"alchemySimulate");function K(t,e,s=""){return u(this,null,function*(){let a=e.query;try{let o=t==="manual"?s===""?a.rpcUrl:s:ve(t);if(o!==void 0){let i={method:"POST",body:JSON.stringify(e.body),agent:(a==null?void 0:a.useTor)==="true"?new pe.SocksProxyAgent(je):null,headers:{"Content-Type":"application/json",Accept:"application/json","infura-source":"metamask/internal",origin:"chrome-extension://nkbihfbeogaeaoehlefnkodbefgpgknn"}};return yield(0,g.default)(o,i).then(l=>l.json())}else{let{rpcResp:i}=w("Invalid RPC Url");return i}}catch(o){let{rpcResp:i}=w(o);return i}})}p(K,"sendToRpc");function xe(t,e){return u(this,null,function*(){let s=e.body,a=e.query;var o=Ie(s.params[0]),i=de.FeeMarketEIP1559Transaction.fromSerializedTx(o),r=i.toJSON();if(console.log("deserializedTx",r),Object.keys(r).includes("to")===!0){let{isMalicious:h,rpcResp:y}=yield V(r.to);if(h==!0&&y)return y.id=s.id,y}let l=parseInt(r.maxFeePerGas||"0")+parseInt(i.maxPriorityFeePerGas.toString(10)||"0"),c={network_id:parseInt(i.chainId.toString(10)),from:i.getSenderAddress().toString(),to:i.to?i.to.toString():"",input:i.data.toString("hex"),gas:parseInt(i.gasLimit.toString(10)),gas_price:l.toString(10),value:parseInt(i.value.toString(10)),save_if_fails:!0,save:!1,simulation_type:"full"},d=yield Fe(c);if(d!=null&&d!=!1&&"transaction_info"in d&&d.transaction_info!=null){console.log("Sim Successful");for(let h=0;h<d.transaction_info.logs.length;h++){let y=d.transaction_info.logs[h];if(y.name==="Approval"||y.name==="Transfer"){let{isMalicious:b,rpcResp:_}=yield V(y.inputs[1].value);if(b===!0)return _}}}if(t!="manual"&&"blockUnverifiedContracts"in a&&a.blockUnverifiedContracts==="true"){let h=yield(0,g.default)(`https://sourcify.dev/server/check-all-by-addresses?addresses=${r==null?void 0:r.to}&chainIds=1,4,11155111,137,80001,10,42161,421611`),y;if(h.ok===!0){if(y=yield h.json(),Object.keys(y).includes("status")){let{rpcResp:b}=w("The contract is unverified");return b}}else{let{rpcResp:b}=w("Sourcify Request Failed");return b}}if(t in["mainnet","polygon","polygon-testnet"]&&(a==null?void 0:a.enableScanners)!==void 0&&r.to!==void 0){let h=t,y=a.enableScanners.split(",");for(let b=0;b<y.length;b++)if(y[b]==="slither"&&(yield B(h,r.to)).results.length>0)return w("Slither detected possible attack vectors")}if((a==null?void 0:a.blockRecentDnsUpdates)!=null&&parseInt(a.blockRecentDnsUpdates)){let h=parseInt(a.blockRecentDnsUpdates),y=yield(0,g.default)(`https://dns.google/resolve?name=${e.hostname}&type=SOA`);if(y.ok===!0){let b=yield y.json();if(b.Answer.length>0&&U(b.Answer[0].data)!=!1){let _=U(b.Answer[0].data);if(_!==!1&&(Date.now()-_.valueOf())/864e5<=h){let{rpcResp:j}=w("The domain's DNS has been changed recently.");return j}}}}return t==="mainnet"&&(a==null?void 0:a.useGasHawk)!=null&&a.useGasHawk==="true"?yield K("manual",e,"https://beta-be.gashawk.io:3001/proxy/rpc"):yield K(t,e)})}p(xe,"processTxs");k.get("/",function(t,e){return e.header("Content-Security-Policy","default-src *; style-src 'self' 'unsafe-inline' cdnjs.cloudflare.com fonts.googleapis.com; script-src 'self' 'unsafe-inline'; img-src data: mintlify.s3-us-west-1.amazonaws.com ;"),e.sendFile("index.html")});k.get("/ping",(t,e)=>u(exports,null,function*(){return e.send({hello:"world"})}));k.get("/blacklist",(t,e)=>u(exports,null,function*(){return e.headers({"Cache-Control":`max-age=${24*60*60}`}),e.send(m.stats())}));k.get("/whitelist",(t,e)=>u(exports,null,function*(){return e.headers({"Cache-Control":`max-age=${24*60*60}`}),e.send(Array.from(I.values()))}));k.get("/tokenlist",(t,e)=>u(exports,null,function*(){return e.headers({"Cache-Control":`max-age=${24*60*60}`}),e.send({tokens:A==null?void 0:A.length})}));k.get("/tor",(t,e)=>u(exports,null,function*(){try{let{stdout:s,stderr:a}=yield Ce("cat /var/lib/tor/hidden_service/hostname");return a==""?e.send({domain:s.replace(`
`,"")}):e.send({domain:!1,error:a})}catch(s){return e.send({domain:!1,error:s})}}));k.get("/blacklist/*",(t,e)=>u(exports,null,function*(){e.headers({"Cache-Control":`max-age=${24*60*60}`});let s=t.params,a=m.get(s["*"]);if(a===void 0)return e.send({blacklisted:!1});{let o=(0,N.closest)(s["*"],Array.from(I)),i=(0,N.distance)(s["*"],o);return e.send({blacklisted:!0,list:q[a],closestWhitelisted:{url:o,distance:i}})}}));k.get("/malicious/:ethAddress",(t,e)=>u(exports,null,function*(){e.headers({"Cache-Control":`max-age=${24*60*60}`});let s=t.params,a=yield V(s.ethAddress);return e.send(a)}));k.get("/tokendeets/:ethAddress",(t,e)=>u(exports,null,function*(){var o,i;e.headers({"Cache-Control":`max-age=${24*60*60}`});let s=t.params;s!=null&&s.ethAddress||e.send([]);let a=[];for(let r=0;r<A.length;r++)(o=A[r])!=null&&o.address&&((i=A[r])==null?void 0:i.address.toLowerCase())===(s==null?void 0:s.ethAddress.toLowerCase())&&a.push(A[r]);return e.send(a)}));k.post("/lifejacket/:jacket",(t,e)=>u(exports,null,function*(){let s=["slither","mythril"],{jacket:a}=t.params;if(s.includes(a)){let{network:o,address:i}=t.body;if(o!=null&&i!=null&&(0,T.isAddress)(i)){if(a==="slither"){let r=yield B(o,i);return e.send(r)}}else return e.send({success:!1,error:"Invalid body params, network or address"})}else return e.send({success:!1,error:`Invalid LifeJacket, supported ${s.toString()}`})}));k.post("/:network",(t,e)=>u(exports,null,function*(){let{hostname:s,ip:a}=t,o=t.body;if(!Te(s)&&!m.get(s)){let{network:r}=t.params;if(W("req",r,o,t.query),r&&D.get(r)){if(Le){let{success:l}=yield se.limit(a);if(l===!1)return e.send({error:"Ratelimit Exceeded"})}if(o.method=="eth_sendRawTransaction"){let l=yield xe(r,t);return e.send(l)}else{if(o.method=="web3_clientVersion")return e.send({jsonrpc:"2.0",id:42,result:"Omnid/Proxy/1.0.0"});{let l=yield K(r,t);return e.send(l)}}}else return e.send({error:`Invalid network '${r}', available networks are ${Array.from(D.keys()).join(", ")}`})}else{let{rpcResp:r}=w(`\u{1F6A8} Phishing detector for the site ${s} has been triggered.`);return e.send(r)}}));k.addHook("preHandler",(t,e,s)=>{e.header("onion-location",`http://omnid2kq4qppsp2a5hgeqok6ahkfo23tdtoe7km4uier4o43taxct5ad.onion${t.url}`),s()});function Ue(){return u(this,null,function*(){m.delete("instagram.com");let t=yield(0,g.default)("https://api.llama.fi/lite/protocols2").then(c=>c.json());t.protocols.forEach(c=>{try{let d=new URL(c.url.replace(`
`,"").replace("\r","")).hostname.replace("www.","");I.add(d),m.delete(d)}catch(d){}}),console.log("\u{1F7E2} DefiLlama Whitelist",t.protocols.length);let e=yield(0,g.default)("https://gist.githubusercontent.com/anudit/8df081a368397dea5ff4ce8bdfac6256/raw/9d36d984fe3ed78bd1f993c4cca22ec4093d9253/index.json").then(c=>c.json()),s=0;Object.values(e.pageProps.defiList).forEach(c=>{try{let d=new URL(c.url).hostname.replace("www.","");I.add(d),m.delete(d),s+=1}catch(d){}}),console.log("\u{1F7E2} DefiPulse Whitelist",s);let a=yield(0,g.default)("https://dap.ps/metadata/all").then(c=>c.json()),o=0,i=Object.values(a);for(let c=0;c<i.length;c++)try{let d=i[c],h=new URL(d.details.url).hostname;I.add(h),m.delete(h),o+=1}catch(d){console.log(d);continue}console.log("\u{1F7E2} Dap.ps Whitelist",o);let r=yield(0,g.default)("https://gist.githubusercontent.com/anudit/a88c5888dcfb7b9cbf14a57d8eca61ad/raw/c9e02047a31989715249c9251e828fbab15d8140/links.json").then(c=>c.json()),l=0;r.forEach(c=>{try{let d=new URL(c.homepage).hostname.replace("www.","");I.add(d),m.delete(d),l+=1}catch(d){}}),console.log("\u{1F7E2} Walletconnect Whitelist",l)})}p(Ue,"clearWhitelist");function ae(){return u(this,null,function*(){let t=m.stats().numKeys;console.log("Compiling Blacklist");let e=[],s=p((n,R=0)=>{let v=m.stats().numKeys,J=v-t,me={Name:q[n].id,Length:R,"Unique Added":`${J.toLocaleString()} [+${(J/R*100).toFixed(2)}%]`,Total:v};return t=v,me},"logStat"),a=yield(0,g.default)("https://raw.githubusercontent.com/409H/EtherAddressLookup/master/blacklists/domains.json").then(n=>n.json());a.forEach(n=>{m.set(n,1)}),e.push(s(1,a.length));let o=yield(0,g.default)("https://raw.githubusercontent.com/MetaMask/eth-phishing-detect/master/src/config.json").then(n=>n.json());o.blacklist.forEach(n=>{m.set(n,2)}),e.push(s(2,o.blacklist.length));let i=yield(0,g.default)("https://raw.githubusercontent.com/MyEtherWallet/ethereum-lists/master/src/urls/urls-darklist.json").then(n=>n.json());i.forEach(n=>{m.set(n.id,3)}),e.push(s(3,i.length));let r=yield(0,g.default)("https://raw.githubusercontent.com/DAOBuidler/MetaShieldExtension/main/function/data/domain_blacklist.json").then(n=>n.json());r.forEach(n=>{let R=n.replace("'","").replace("http://","").replace("https://","");m.set(R,4)}),e.push(s(4,r.length));try{let n=yield(0,g.default)("https://api.cryptoscamdb.org/v1/blacklist").then(R=>R.json());n.result.forEach(R=>{m.set(R,5)}),e.push(s(5,n.result.length))}catch(n){}let c=yield(yield(0,g.default)("https://gist.githubusercontent.com/anudit/643a5a5a7b105a563836578fa6dfdbd1/raw/964215961af0bdce8e64a112da52a022f4679cf7/Chainabuse-ScamDomains.json")).json();c.forEach(n=>{m.set(n,7)}),e.push(s(7,c.length));let h=(yield(yield(0,g.default)("https://raw.githubusercontent.com/mitchellkrogza/Phishing.Database/master/phishing-domains-ACTIVE.txt")).text()).split(`
`);for(let n=0;n<h.length;n++)try{m.set(h[n],8)}catch(R){continue}e.push(s(8,h.length));let b=yield yield(0,g.default)("https://phish.sinking.yachts/v2/all").then(n=>n.json());b.forEach(n=>{m.set(n,9)}),e.push(s(9,b.length));let C=(yield(yield(0,g.default)("https://raw.githubusercontent.com/stamparm/aux/master/maltrail-malware-domains.txt")).text()).split(`
`);for(let n=0;n<C.length;n++)try{m.set(C[n],10)}catch(R){continue}e.push(s(10,C.length));let j=yield(0,g.default)("https://raw.githubusercontent.com/scamsniffer/scam-database/main/blacklist/domains.json").then(n=>n.json());j.forEach(n=>{m.set(n,11)}),e.push(s(11,j.length));let H=yield(0,g.default)("https://raw.githubusercontent.com/phishfort/phishfort-lists/master/blacklists/domains.json").then(n=>n.json());H.forEach(n=>{m.set(n,12)}),e.push(s(12,H.length));let Y=(yield(0,g.default)("https://raw.githubusercontent.com/blueshell-io/scamdb/bec21924d47b3391196b7bb701316a75a3ac6009/website.json").then(n=>n.json())).data.map(n=>n.scams).flat().filter(n=>n!=null).map(n=>n.url).filter(n=>n!="");Y.forEach(n=>{try{let R=new URL(n).hostname;m.set(R,13)}catch(R){}}),e.push(s(13,Y.length)),console.table(e),yield Ue()})}p(ae,"compileBlacklist");function Oe(){return u(this,null,function*(){A=yield ee();let t=[],e=p((s,a=0)=>({Network:s,"RPC Set":a}),"logStat");D.forEach((s,a)=>{t.push(e(a,x(s).length))}),console.table(t)})}p(Oe,"rpcSet");k.listen({port:parseInt(f("PORT"))||80,host:"0.0.0.0"},(t,e)=>{if(Oe(),ae(),setInterval(ae,60*60*1e3),!t)console.log("\u{1F680} Server is listening on",e);else throw t});
