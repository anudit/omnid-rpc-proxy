"use strict";var me=Object.create;var N=Object.defineProperty;var ge=Object.getOwnPropertyDescriptor;var ye=Object.getOwnPropertyNames;var ke=Object.getPrototypeOf,be=Object.prototype.hasOwnProperty;var p=(t,e)=>N(t,"name",{value:e,configurable:!0});var we=(t,e,s,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ye(e))!be.call(t,i)&&i!==s&&N(t,i,{get:()=>e[i],enumerable:!(a=ge(e,i))||a.enumerable});return t};var R=(t,e,s)=>(s=t!=null?me(ke(t)):{},we(e||!t||!t.__esModule?N(s,"default",{value:t,enumerable:!0}):s,t));var d=(t,e,s)=>new Promise((a,i)=>{var n=g=>{try{m(s.next(g))}catch(f){i(f)}},o=g=>{try{m(s.throw(g))}catch(f){i(f)}},m=g=>g.done?a(g.value):Promise.resolve(g.value).then(n,o);m((s=s.apply(t,e)).next())});var re=R(require("fastify")),ne=R(require("@fastify/helmet")),oe=R(require("@fastify/compress")),ie=R(require("@fastify/cors")),le=R(require("@fastify/static")),ce=R(require("path")),h=R(require("cross-fetch")),de=require("@ethereumjs/tx"),ue=require("@theconvospace/sdk"),I=require("@ethersproject/address");require("dotenv").config({path:".env"});var k=p(t=>{let e=process.env[t];if(e===void 0)throw new Error(`'${t}' Environment Variable is Not Defined`);return e},"getEnv"),O=p(t=>JSON.parse(k(t)),"getEnvJson"),z=p((...t)=>{k("DEBUG")==="true"&&console.log(...t)},"debugLog"),F=p(t=>{let s=t.split(" ")[2];if(s.length===10)try{return parseInt(s.slice(0,2))<=16?new Date(parseInt(s+"000")):new Date(parseInt(s.slice(0,4)),parseInt(s.slice(4,6)),parseInt(s.slice(6,8)),0,0,0,0)}catch(a){return!1}else return!1},"parseSerialFromAnswerData");var _=R(require("path")),ee=R(require("util")),P=require("fs/promises"),M=require("fs"),x=require("@ethersproject/address"),te=R(require("cross-fetch"));var Q=R(require("util"));var Re=Q.default.promisify(require("child_process").exec);function X(t){return d(this,null,function*(){let{stderr:e}=yield Re(`solc-select use ${t}`);return e===""?!0:(console.error(e),!1)})}p(X,"setSolidityVersion");var Z=new Map([["mainnet",`https://api.etherscan.io/api?apikey=${k("ETHERSCAN_API_KEY")}`],["polygon",`https://api.polygonscan.com/api?apikey=${k("POLYGONSCAN_API_KEY")}`],["polygon-testnet",`https://api-testnet.polygonscan.com/api?apikey=${k("POLYGONSCAN_API_KEY")}`]]);var Se=ee.default.promisify(require("child_process").exec);function Ae(t,e,s){return d(this,null,function*(){var g;let a=_.default.join(__dirname,"../contracts");(0,M.existsSync)(a)||(0,M.mkdirSync)(a);let i=t+"-"+(0,x.getAddress)(e);yield(0,P.writeFile)(_.default.join(a,i+".sol"),s);let n=`slither ${_.default.join(a,i+".sol")} --json ${_.default.join(a,i+".json")} --exclude-low --exclude-medium --exclude-informational --exclude-optimization --solc-disable-warnings`;try{let{stdout:f,stderr:l}=yield Se(n)}catch(f){}let o=yield(0,P.readFile)(_.default.join(a,i+".json"),{encoding:"utf8"}),m=JSON.parse(o.toString());return m.success===!0&&((g=m.results)==null?void 0:g.detectors)!=null&&m.results.detectors.length>0?(console.log("storeAndRun/foundIssue"),{foundIssue:!0,data:m.results.detectors}):(console.log("storeAndRun/Nothing Found"),{foundIssue:!1,data:[]})})}p(Ae,"storeAndRun");function U(t,e){return d(this,null,function*(){var i;let s=t+"-"+(0,x.getAddress)(e),a=_.default.join(__dirname,"../contracts",s+".json");if((0,M.existsSync)(a)){let n=yield(0,P.readFile)(a,{encoding:"utf8"}),o=JSON.parse(n.toString());return o.success===!0&&((i=o.results)==null?void 0:i.detectors)!=null&&o.results.detectors.length>0?{cached:!0,success:!0,results:o.results.detectors,error:""}:{cached:!0,success:!0,results:[],error:""}}else{let n=yield(0,te.default)(`${Z.get(t)}&module=contract&action=getsourcecode&address=${e}`);if(n.ok===!0){let o=yield n.json();if(o.status=="1"&&o.result.length>0)if(o.result[0].Proxy==="0"){let m=o.result[0].SourceCode,g=o.result[0].CompilerVersion.split("+")[0].slice(1),f=yield X(g);if(console.log("setVersionResp",g,f),f===!0){let l=yield Ae(t,e,m);return l.foundIssue?{success:!0,results:l.data,error:""}:{success:!0,results:[],error:""}}else return console.log("Failed to set Solidity Version."),{success:!1,error:"Failed to set Solidity Version.",results:[]}}else return{success:!1,error:"Proxy",results:[]};else return console.log("Source code not verified on EtherScan"),{success:!1,error:"Source code not verified on EtherScan",results:[]}}else return console.log("Error Fetching Source Code from EtherScan"),{success:!1,error:"Error Fetching Source Code from EtherScan",results:[]}}})}p(U,"testUsingSlither");var D=require("fastest-levenshtein"),pe=require("socks-proxy-agent"),he=R(require("util"));var q={1:{id:"409H/EtherAddressLookup",name:"EtherAddressLookup",link:"https://github.com/409H/EtherAddressLookup"},2:{id:"MetaMask/eth-phishing-detect",name:"EthPhishingDetector",link:"https://github.com/MetaMask/eth-phishing-detect"},3:{id:"MyEtherWallet/ethereum-lists",name:"MyEtherWallet",link:"https://github.com/MyEtherWallet/ethereum-lists"},4:{id:"DAOBuidler/MetaShieldExtension",name:"MetaShield",link:"https://www.metashield.cc/indexen.html"},5:{id:"cryptoscamdb",name:"CryptoScamDB",link:"https://cryptoscamdb.org/"},6:{id:"walletguard",name:"Wallet Guard",link:"https://walletguard.app/"},7:{id:"anudit/chainabuse",name:"Chainabuse",link:"https://www.chainabuse.com/"},8:{id:"mitchellkrogza/Phishing.Database",name:"Phishing Domain Database",link:"https://github.com/mitchellkrogza/Phishing.Database"},9:{id:"phish.sinking.yachts",name:"SinkingYachts",link:"https://phish.sinking.yachts/"},10:{id:"stamparm/aux",name:"stamparm/aux",link:"https://github.com/stamparm/aux"},11:{id:"scamsniffer/scam-database",name:"ScamSniffer",link:"https://scamsniffer.io/"},12:{id:"phishfort/phishfort-lists",name:"PhishFort",link:"https://www.phishfort.com/"},13:{id:"blueshell-io/scamdb",name:"BlueShell",link:"https://blueshell.io/"}};var B=R(require("cross-fetch"));function Ee(){return d(this,null,function*(){console.log("Compiling tokenlists");let t={1:"https://account.metafi.codefi.network/networks/1/tokens",10:"https://account.metafi.codefi.network/networks/10/tokens",137:"https://account.metafi.codefi.network/networks/137/tokens",51:"https://account.metafi.codefi.network/networks/56/tokens",43114:"https://account.metafi.codefi.network/networks/43114/tokens",42161:"https://account.metafi.codefi.network/networks/42161/tokens",250:"https://account.metafi.codefi.network/networks/250/tokens"},e=Object.keys(t).map(n=>(0,B.default)(t[n]).then(o=>o.json())),s=yield Promise.allSettled(e),a=[];for(let n=0;n<s.length;n++){let o=s[n];o.status=="fulfilled"&&(a=a.concat(o.value))}a.push({name:"Matic",symbol:"MATIC",decimals:18,address:"0x0000000000000000000000000000000000001010",iconUrl:"https://tokens.1inch.io/0x7d1afa7b718fb893db30a3abc0cfc608aacfebb0.png",sources:["https://wiki.polygon.technology/docs/faq/wallet-bridge-faq/#why-is-the-matic-token-is-not-supported-on-pos"],chainId:137,coingeckoId:"matic-network"});let i=yield(0,B.default)("https://raw.githubusercontent.com/MetaMask/contract-metadata/master/contract-map.json").then(n=>n.json());for(let[n,o]of Object.entries(i))a.push({name:o.name,symbol:o.symbol,decimals:o.decimals,address:n,iconUrl:"https://raw.githubusercontent.com/MetaMask/contract-metadata/master/images/"+o.logo,sources:["https://github.com/MetaMask/contract-metadata"],chainId:1});return console.log("\u{1FA99} ",a.length,"Tokens"),a})}p(Ee,"getTokenLists");var se=Ee;var b=(0,re.default)({logger:!1}),_e=require("ethereumjs-util").toBuffer,Ce=require("eth-phishing-detect"),Ie=he.default.promisify(require("child_process").exec);b.register(ne.default,{global:!0});b.register(oe.default,{global:!0});b.register(ie.default,{origin:"*"});b.register(le.default,{root:ce.default.join(__dirname,"../public")});var Te=require("megahash"),u=new Te,A=new Set,Pe=`https://api.tenderly.co/api/v1/account/${k("TENDERLY_USER")}/project/${k("TENDERLY_PROJECT")}/simulate`,Me="socks5://0.0.0.0:9150",E=[],je=new ue.Convo(k("CONVO_API_KEY")),De={alchemyApiKey:k("ALCHEMY_API_KEY"),CNVSEC_ID:k("CNVSEC_ID"),etherscanApiKey:k("ETHERSCAN_API_KEY"),polygonscanApiKey:k("POLYGONSCAN_API_KEY"),optimismscanApiKey:k("OPTIMISMSCAN_API_KEY"),polygonMainnetRpc:"",etherumMainnetRpc:"",avalancheMainnetRpc:"",maticPriceInUsd:0,etherumPriceInUsd:0,deepdaoApiKey:"",zapperApiKey:"",DEBUG:!1},j=new Map([["mainnet","MAINNET_RPC_URL"],["mainnet-flashbots","MAINNET_FLASHBOTS_RPC_URL"],["mainnet-flashbots-fast","MAINNET_FLASHBOTS_FAST_RPC_URL"],["rinkeby","RINKEBY_RPC_URL"],["goerli","GOERLI_RPC_URL"],["sepolia","SEPOLIA_RPC_URL"],["goerli-flashbots","GOERLI_FLASHBOTS_RPC_URL"],["polygon","POLYGON_RPC_URL"],["polygon-testnet","POLYGON_TESTNET_RPC_URL"],["polygon-zkevm","POLYGON_ZKEVM_RPC_URL"],["optimism","OPTIMISM_RPC_URL"],["optimism-testnet","OPTIMISM_TESTNET_RPC_URL"],["optimism-bedrock","OPTIMISM_BEDROCK_RPC_URL"],["arbitrum","ARBITRUM_RPC_URL"],["arbitrum-nova","ARBITRUM_NOVA_RPC_URL"],["arbitrum-testnet","ARBITRUM_TESTNET_RPC_URL"],["bsc","BSC_RPC_URL"],["bsc-testnet","BSC_TESTNET_RPC_URL"],["fantom","FANTOM_RPC_URL"],["fantom-testnet","FANTOM_TESTNET_RPC_URL"]]),Le=p(t=>{let e=j.get(t);if(e){let s=O(e);return s[Math.floor(Math.random()*s.length)]}else return""},"networkToRpc");function w(t,e=void 0){return{isMalicious:!0,rpcResp:{id:420,jsonrpc:"2.0",error:{code:-32003,message:t}},details:e}}p(w,"getMalRpcError");function $(t){return d(this,null,function*(){try{if((0,I.isAddress)(t)){let e=yield je.omnid.kits.isMalicious((0,I.getAddress)(t),De);return console.log("omnid.kits.isMalicious",(0,I.getAddress)(t),e),(e==null?void 0:e.alchemy)&&e.alchemy===!0?w("Spam Contract Flagged by Alchemy",e):(e==null?void 0:e.chainabuse)&&Boolean(e.chainabuse)===!0?w("Contract Flagged by Chainabuse",e):(e==null?void 0:e.scanblocks)&&e.scanblocks===!0?w("Address Flagged by Scanblocks",e):(e==null?void 0:e.cryptoscamdb)&&e.cryptoscamdb===!0?w("Contract Flagged by CryptoscamDB",e):(e==null?void 0:e.etherscan)&&"label"in e.etherscan?w(`Address Flagged as ${e.etherscan.label} by Etherscan`,e):(e==null?void 0:e.mew)&&"comment"in e.mew?w("Address Flagged by MyEtherWallet",e):e!=null&&e.sdn?w("Address Flagged by OFAC",e):e!=null&&e.tokenblacklist?w("Address Blacklisted by Stablecoin",e):e!=null&&e.txn?w("Address/Contract Funded by Tornado Cash.",e):{isMalicious:!1}}else return{isMalicious:!1}}catch(e){return{isMalicious:!1}}})}p($,"checkAddress");function ve(t){return d(this,null,function*(){try{return yield(0,h.default)(Pe,{method:"POST",body:JSON.stringify(t),headers:{"X-Access-Key":k("TENDERLY_ACCESS_KEY")}}).then(s=>s.json())}catch(e){return console.log("alchemySimulate",e),!1}})}p(ve,"alchemySimulate");function V(t,e,s=""){return d(this,null,function*(){let a=e.query;try{let i=t==="manual"?s===""?a.rpcUrl:s:Le(t);if(i!==void 0){let n={method:"POST",body:JSON.stringify(e.body),agent:(a==null?void 0:a.useTor)==="true"?new pe.SocksProxyAgent(Me):null,headers:{"Content-Type":"application/json",Accept:"application/json","infura-source":"metamask/internal",origin:"chrome-extension://nkbihfbeogaeaoehlefnkodbefgpgknn"}};return yield(0,h.default)(i,n).then(m=>m.json())}else{let{rpcResp:n}=w("Invalid RPC Url");return n}}catch(i){let{rpcResp:n}=w(i);return n}})}p(V,"sendToRpc");function Ne(t,e){return d(this,null,function*(){let s=e.body,a=e.query;var i=_e(s.params[0]),n=de.FeeMarketEIP1559Transaction.fromSerializedTx(i),o=n.toJSON();if(console.log("deserializedTx",o),Object.keys(o).includes("to")===!0){let{isMalicious:l,rpcResp:c}=yield $(o.to);if(l==!0&&c)return c.id=s.id,c}let m=parseInt(o.maxFeePerGas||"0")+parseInt(n.maxPriorityFeePerGas.toString(10)||"0"),g={network_id:parseInt(n.chainId.toString(10)),from:n.getSenderAddress().toString(),to:n.to?n.to.toString():"",input:n.data.toString("hex"),gas:parseInt(n.gasLimit.toString(10)),gas_price:m.toString(10),value:parseInt(n.value.toString(10)),save_if_fails:!0,save:!1,simulation_type:"full"},f=yield ve(g);if(f!=null&&f!=!1&&"transaction_info"in f&&f.transaction_info!=null){console.log("Sim Successful");for(let l=0;l<f.transaction_info.logs.length;l++){let c=f.transaction_info.logs[l];if(c.name==="Approval"||c.name==="Transfer"){let{isMalicious:y,rpcResp:C}=yield $(c.inputs[1].value);if(y===!0)return C}}}if(t!="manual"&&"blockUnverifiedContracts"in a&&a.blockUnverifiedContracts==="true"){let l=yield(0,h.default)(`https://sourcify.dev/server/check-all-by-addresses?addresses=${o==null?void 0:o.to}&chainIds=1,4,11155111,137,80001,10,42161,421611`),c;if(l.ok===!0){if(c=yield l.json(),Object.keys(c).includes("status")){let{rpcResp:y}=w("The contract is unverified");return y}}else{let{rpcResp:y}=w("Sourcify Request Failed");return y}}if(t in["mainnet","polygon","polygon-testnet"]&&(a==null?void 0:a.enableScanners)!==void 0&&o.to!==void 0){let l=t,c=a.enableScanners.split(",");for(let y=0;y<c.length;y++)if(c[y]==="slither"&&(yield U(l,o.to)).results.length>0)return w("Slither detected possible attack vectors")}if((a==null?void 0:a.blockRecentDnsUpdates)!=null&&Boolean(parseInt(a.blockRecentDnsUpdates))===!0){let l=parseInt(a.blockRecentDnsUpdates),c=yield(0,h.default)(`https://dns.google/resolve?name=${e.hostname}&type=SOA`);if(c.ok===!0){let y=yield c.json();if(y.Answer.length>0&&F(y.Answer[0].data)!=!1){let C=F(y.Answer[0].data);if(C!==!1&&(Date.now()-C.valueOf())/864e5<=l){let{rpcResp:K}=w("The domain's DNS has been changed recently.");return K}}}}return t==="mainnet"&&(a==null?void 0:a.useGasHawk)!=null&&a.useGasHawk==="true"?yield V("manual",e,"https://beta-be.gashawk.io:3001/proxy/rpc"):yield V(t,e)})}p(Ne,"processTxs");b.get("/",function(t,e){return e.header("Content-Security-Policy","default-src *; style-src 'self' 'unsafe-inline' cdnjs.cloudflare.com fonts.googleapis.com; script-src 'self' 'unsafe-inline'; img-src data: mintlify.s3-us-west-1.amazonaws.com ;"),e.sendFile("index.html")});b.get("/ping",(t,e)=>d(exports,null,function*(){return e.send({hello:"world"})}));b.get("/blacklist",(t,e)=>d(exports,null,function*(){return e.headers({"Cache-Control":`max-age=${24*60*60}`}),e.send(u.stats())}));b.get("/whitelist",(t,e)=>d(exports,null,function*(){return e.headers({"Cache-Control":`max-age=${24*60*60}`}),e.send(Array.from(A.values()))}));b.get("/tokenlist",(t,e)=>d(exports,null,function*(){return e.headers({"Cache-Control":`max-age=${24*60*60}`}),e.send({tokens:E==null?void 0:E.length})}));b.get("/tor",(t,e)=>d(exports,null,function*(){try{let{stdout:s,stderr:a}=yield Ie("cat /var/lib/tor/hidden_service/hostname");return a==""?e.send({domain:s.replace(`
`,"")}):e.send({domain:!1,error:a})}catch(s){return e.send({domain:!1,error:s})}}));b.get("/blacklist/*",(t,e)=>d(exports,null,function*(){e.headers({"Cache-Control":`max-age=${24*60*60}`});let s=t.params,a=u.get(s["*"]);if(a===void 0)return e.send({blacklisted:!1});{let i=(0,D.closest)(s["*"],Array.from(A)),n=(0,D.distance)(s["*"],i);return e.send({blacklisted:!0,list:q[a],closestWhitelisted:{url:i,distance:n}})}}));b.get("/malicious/:ethAddress",(t,e)=>d(exports,null,function*(){e.headers({"Cache-Control":`max-age=${24*60*60}`});let s=t.params,a=yield $(s.ethAddress);return e.send(a)}));b.get("/tokendeets/:ethAddress",(t,e)=>d(exports,null,function*(){var i,n;e.headers({"Cache-Control":`max-age=${24*60*60}`});let s=t.params;Boolean(s==null?void 0:s.ethAddress)===!1&&e.send([]);let a=[];for(let o=0;o<E.length;o++)Boolean((i=E[o])==null?void 0:i.address)&&((n=E[o])==null?void 0:n.address.toLowerCase())===(s==null?void 0:s.ethAddress.toLowerCase())&&a.push(E[o]);return e.send(a)}));b.post("/lifejacket/:jacket",(t,e)=>d(exports,null,function*(){let s=["slither","mythril"],{jacket:a}=t.params;if(s.includes(a)){let{network:i,address:n}=t.body;if(i!=null&&n!=null&&(0,I.isAddress)(n)){if(a==="slither"){let o=yield U(i,n);return e.send(o)}}else return e.send({success:!1,error:"Invalid body params, network or address"})}else return e.send({success:!1,error:`Invalid LifeJacket, supported ${s.toString()}`})}));b.post("/:network",(t,e)=>d(exports,null,function*(){let{hostname:s}=t,a=t.body;if(!Ce(s)&&Boolean(u.get(s))===!1){let{network:n}=t.params;if(z("req",n,a,t.query),n&&j.get(n))if(a.method=="eth_sendRawTransaction"){let o=yield Ne(n,t);return e.send(o)}else{if(a.method=="web3_clientVersion")return e.send({jsonrpc:"2.0",id:42,result:"Omnid/Proxy/1.0.0"});{let o=yield V(n,t);return e.send(o)}}else return e.send({error:`Invalid network '${n}', available networks are ${Array.from(j.keys()).join(", ")}`})}else{let{rpcResp:n}=w(`\u{1F6A8} Phishing detector for the site ${s} has been triggered.`);return e.send(n)}}));b.addHook("preHandler",(t,e,s)=>{e.header("onion-location",`http://omnid2kq4qppsp2a5hgeqok6ahkfo23tdtoe7km4uier4o43taxct5ad.onion${t.url}`),s()});function Oe(){return d(this,null,function*(){u.delete("instagram.com");let t=yield(0,h.default)("https://api.llama.fi/lite/protocols2").then(l=>l.json());t.protocols.forEach(l=>{try{let c=new URL(l.url.replace(`
`,"").replace("\r","")).hostname.replace("www.","");A.add(c),u.delete(c)}catch(c){}}),console.log("\u{1F7E2} DefiLlama Whitelist",t.protocols.length);let e=yield(0,h.default)("https://api2.thedapplist.com/api/v2/proposals/listed?offset=0&limit=1000000").then(l=>l.json()),s=0;Object.values(e.data.list).forEach(l=>{try{if(l.numberOfVotes>=5){let c=new URL(l.url).hostname.replace("www.","");A.add(c),u.delete(c),s+=1}}catch(c){}}),console.log("\u{1F7E2} Dapplist Whitelist",s);let a=yield(0,h.default)("https://gist.githubusercontent.com/anudit/8df081a368397dea5ff4ce8bdfac6256/raw/9d36d984fe3ed78bd1f993c4cca22ec4093d9253/index.json").then(l=>l.json()),i=0;Object.values(a.pageProps.defiList).forEach(l=>{try{let c=new URL(l.url).hostname.replace("www.","");A.add(c),u.delete(c),i+=1}catch(c){}}),console.log("\u{1F7E2} DefiPulse Whitelist",i);let n=yield(0,h.default)("https://dap.ps/metadata/all").then(l=>l.json()),o=0,m=Object.values(n);for(let l=0;l<m.length;l++)try{let c=m[l],y=new URL(c.details.url).hostname;A.add(y),u.delete(y),o+=1}catch(c){console.log(c);continue}console.log("\u{1F7E2} Dap.ps Whitelist",o);let g=yield(0,h.default)("https://gist.githubusercontent.com/anudit/a88c5888dcfb7b9cbf14a57d8eca61ad/raw/c9e02047a31989715249c9251e828fbab15d8140/links.json").then(l=>l.json()),f=0;g.forEach(l=>{try{let c=new URL(l.homepage).hostname.replace("www.","");A.add(c),u.delete(c),f+=1}catch(c){}}),console.log("\u{1F7E2} Walletconnect Whitelist",f)})}p(Oe,"clearWhitelist");function ae(){return d(this,null,function*(){let t=u.stats().numKeys;console.log("Compiling Blacklist");let e=[],s=p((r,S=0)=>{let v=u.stats().numKeys,G=v-t,fe={Name:q[r].id,Length:S,"Unique Added":`${G.toLocaleString()} [+${(G/S*100).toFixed(2)}%]`,Total:v};return t=v,fe},"logStat"),a=yield(0,h.default)("https://raw.githubusercontent.com/409H/EtherAddressLookup/master/blacklists/domains.json").then(r=>r.json());a.forEach(r=>{u.set(r,1)}),e.push(s(1,a.length));let i=yield(0,h.default)("https://raw.githubusercontent.com/MetaMask/eth-phishing-detect/master/src/config.json").then(r=>r.json());i.blacklist.forEach(r=>{u.set(r,2)}),e.push(s(2,i.blacklist.length));let n=yield(0,h.default)("https://raw.githubusercontent.com/MyEtherWallet/ethereum-lists/master/src/urls/urls-darklist.json").then(r=>r.json());n.forEach(r=>{u.set(r.id,3)}),e.push(s(3,n.length));let o=yield(0,h.default)("https://raw.githubusercontent.com/DAOBuidler/MetaShieldExtension/main/function/data/domain_blacklist.json").then(r=>r.json());o.forEach(r=>{let S=r.replace("'","").replace("http://","").replace("https://","");u.set(S,4)}),e.push(s(4,o.length));let m=yield(0,h.default)("https://api.cryptoscamdb.org/v1/blacklist").then(r=>r.json());m.result.forEach(r=>{u.set(r,5)}),e.push(s(5,m.result.length));let g=yield(0,h.default)("https://wallet-guard-server-prod.herokuapp.com/lists/all",{method:"GET",redirect:"follow",headers:{Origin:"chrome-extension://pdgbckgdncnhihllonhnjbdoighgpimk"}}),f=JSON.parse(yield g.text());f.blocklist.forEach(r=>{u.set(r,6)}),JSON.parse(f.whitelist).map(r=>r.extensions.map(S=>r.key+S)).flat().forEach(r=>{A.add(r),u.delete(r)}),e.push(s(6,f.blocklist.length));let y=yield(yield(0,h.default)("https://gist.githubusercontent.com/anudit/643a5a5a7b105a563836578fa6dfdbd1/raw/964215961af0bdce8e64a112da52a022f4679cf7/Chainabuse-ScamDomains.json")).json();y.forEach(r=>{u.set(r,7)}),e.push(s(7,y.length));let T=(yield(yield(0,h.default)("https://raw.githubusercontent.com/mitchellkrogza/Phishing.Database/master/phishing-domains-ACTIVE.txt")).text()).split(`
`);for(let r=0;r<T.length;r++)try{u.set(T[r],8)}catch(S){continue}e.push(s(8,T.length));let Y=yield yield(0,h.default)("https://phish.sinking.yachts/v2/all").then(r=>r.json());Y.forEach(r=>{u.set(r,9)}),e.push(s(9,Y.length));let L=(yield(yield(0,h.default)("https://raw.githubusercontent.com/stamparm/aux/master/maltrail-malware-domains.txt")).text()).split(`
`);for(let r=0;r<L.length;r++)try{u.set(L[r],10)}catch(S){continue}e.push(s(10,L.length));let J=yield(0,h.default)("https://raw.githubusercontent.com/scamsniffer/scam-database/main/blacklist/domains.json").then(r=>r.json());J.forEach(r=>{u.set(r,11)}),e.push(s(11,J.length));let H=yield(0,h.default)("https://raw.githubusercontent.com/phishfort/phishfort-lists/master/blacklists/domains.json").then(r=>r.json());H.forEach(r=>{u.set(r,12)}),e.push(s(12,H.length));let W=(yield(0,h.default)("https://raw.githubusercontent.com/blueshell-io/scamdb/bec21924d47b3391196b7bb701316a75a3ac6009/website.json").then(r=>r.json())).data.map(r=>r.scams).flat().filter(r=>r!=null).map(r=>r.url).filter(r=>r!="");W.forEach(r=>{try{let S=new URL(r).hostname;u.set(S,13)}catch(S){}}),e.push(s(13,W.length)),console.table(e),yield Oe()})}p(ae,"compileBlacklist");function Fe(){return d(this,null,function*(){E=yield se();let t=[],e=p((s,a=0)=>({Network:s,"RPC Set":a}),"logStat");j.forEach((s,a)=>{t.push(e(a,O(s).length))}),console.table(t)})}p(Fe,"rpcSet");b.listen({port:parseInt(k("PORT"))||80,host:"0.0.0.0"},(t,e)=>{if(Fe(),ae(),setInterval(ae,60*60*1e3),!t)console.log("\u{1F680} Server is listening on",e);else throw t});
