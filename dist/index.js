"use strict";var fe=Object.create;var v=Object.defineProperty;var me=Object.getOwnPropertyDescriptor;var ge=Object.getOwnPropertyNames;var ye=Object.getPrototypeOf,ke=Object.prototype.hasOwnProperty;var u=(t,e)=>v(t,"name",{value:e,configurable:!0});var be=(t,e,s,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ge(e))!ke.call(t,i)&&i!==s&&v(t,i,{get:()=>e[i],enumerable:!(a=me(e,i))||a.enumerable});return t};var R=(t,e,s)=>(s=t!=null?fe(ye(t)):{},be(e||!t||!t.__esModule?v(s,"default",{value:t,enumerable:!0}):s,t));var d=(t,e,s)=>new Promise((a,i)=>{var n=g=>{try{m(s.next(g))}catch(f){i(f)}},o=g=>{try{m(s.throw(g))}catch(f){i(f)}},m=g=>g.done?a(g.value):Promise.resolve(g.value).then(n,o);m((s=s.apply(t,e)).next())});var ae=R(require("fastify")),re=R(require("@fastify/helmet")),ne=R(require("@fastify/compress")),oe=R(require("@fastify/cors")),ie=require("fs"),le=R(require("path")),h=R(require("cross-fetch")),ce=require("@ethereumjs/tx"),de=require("@theconvospace/sdk"),C=require("@ethersproject/address");require("dotenv").config({path:".env"});var k=u(t=>{let e=process.env[t];if(e===void 0)throw new Error(`'${t}' Environment Variable is Not Defined`);return e},"getEnv"),O=u(t=>JSON.parse(k(t)),"getEnvJson"),F=u(t=>{let s=t.split(" ")[2];if(s.length===10)try{return parseInt(s.slice(0,2))<=16?new Date(parseInt(s+"000")):new Date(parseInt(s.slice(0,4)),parseInt(s.slice(4,6)),parseInt(s.slice(6,8)),0,0,0,0)}catch(a){return!1}else return!1},"parseSerialFromAnswerData");var E=R(require("path")),Z=R(require("util")),T=require("fs/promises"),P=require("fs"),x=require("@ethersproject/address"),ee=R(require("cross-fetch"));var z=R(require("util"));var we=z.default.promisify(require("child_process").exec);function Q(t){return d(this,null,function*(){let{stderr:e}=yield we(`solc-select use ${t}`);return e===""?!0:(console.error(e),!1)})}u(Q,"setSolidityVersion");var X=new Map([["mainnet",`https://api.etherscan.io/api?apikey=${k("ETHERSCAN_API_KEY")}`],["polygon",`https://api.polygonscan.com/api?apikey=${k("POLYGONSCAN_API_KEY")}`],["polygon-testnet",`https://api-testnet.polygonscan.com/api?apikey=${k("POLYGONSCAN_API_KEY")}`]]);var Re=Z.default.promisify(require("child_process").exec);function Se(t,e,s){return d(this,null,function*(){var g;let a=E.default.join(__dirname,"../contracts");(0,P.existsSync)(a)||(0,P.mkdirSync)(a);let i=t+"-"+(0,x.getAddress)(e);yield(0,T.writeFile)(E.default.join(a,i+".sol"),s);let n=`slither ${E.default.join(a,i+".sol")} --json ${E.default.join(a,i+".json")} --exclude-low --exclude-medium --exclude-informational --exclude-optimization --solc-disable-warnings`;try{let{stdout:f,stderr:l}=yield Re(n)}catch(f){}let o=yield(0,T.readFile)(E.default.join(a,i+".json"),{encoding:"utf8"}),m=JSON.parse(o.toString());return m.success===!0&&((g=m.results)==null?void 0:g.detectors)!=null&&m.results.detectors.length>0?(console.log("storeAndRun/foundIssue"),{foundIssue:!0,data:m.results.detectors}):(console.log("storeAndRun/Nothing Found"),{foundIssue:!1,data:[]})})}u(Se,"storeAndRun");function U(t,e){return d(this,null,function*(){var i;let s=t+"-"+(0,x.getAddress)(e),a=E.default.join(__dirname,"../contracts",s+".json");if((0,P.existsSync)(a)){let n=yield(0,T.readFile)(a,{encoding:"utf8"}),o=JSON.parse(n.toString());return o.success===!0&&((i=o.results)==null?void 0:i.detectors)!=null&&o.results.detectors.length>0?{cached:!0,success:!0,results:o.results.detectors,error:""}:{cached:!0,success:!0,results:[],error:""}}else{let n=yield(0,ee.default)(`${X.get(t)}&module=contract&action=getsourcecode&address=${e}`);if(n.ok===!0){let o=yield n.json();if(o.status=="1"&&o.result.length>0)if(o.result[0].Proxy==="0"){let m=o.result[0].SourceCode,g=o.result[0].CompilerVersion.split("+")[0].slice(1),f=yield Q(g);if(console.log("setVersionResp",g,f),f===!0){let l=yield Se(t,e,m);return l.foundIssue?{success:!0,results:l.data,error:""}:{success:!0,results:[],error:""}}else return console.log("Failed to set Solidity Version."),{success:!1,error:"Failed to set Solidity Version.",results:[]}}else return{success:!1,error:"Proxy",results:[]};else return console.log("Source code not verified on EtherScan"),{success:!1,error:"Source code not verified on EtherScan",results:[]}}else return console.log("Error Fetching Source Code from EtherScan"),{success:!1,error:"Error Fetching Source Code from EtherScan",results:[]}}})}u(U,"testUsingSlither");var L=require("fastest-levenshtein"),pe=require("socks-proxy-agent"),ue=R(require("util"));var q={1:{id:"409H/EtherAddressLookup",name:"EtherAddressLookup",link:"https://github.com/409H/EtherAddressLookup"},2:{id:"MetaMask/eth-phishing-detect",name:"EthPhishingDetector",link:"https://github.com/MetaMask/eth-phishing-detect"},3:{id:"MyEtherWallet/ethereum-lists",name:"MyEtherWallet",link:"https://github.com/MyEtherWallet/ethereum-lists"},4:{id:"DAOBuidler/MetaShieldExtension",name:"MetaShield",link:"https://www.metashield.cc/indexen.html"},5:{id:"cryptoscamdb",name:"CryptoScamDB",link:"https://cryptoscamdb.org/"},6:{id:"walletguard",name:"Wallet Guard",link:"https://walletguard.app/"},7:{id:"anudit/chainabuse",name:"Chainabuse",link:"https://www.chainabuse.com/"},8:{id:"mitchellkrogza/Phishing.Database",name:"Phishing Domain Database",link:"https://github.com/mitchellkrogza/Phishing.Database"},9:{id:"phish.sinking.yachts",name:"SinkingYachts",link:"https://phish.sinking.yachts/"},10:{id:"stamparm/aux",name:"stamparm/aux",link:"https://github.com/stamparm/aux"},11:{id:"scamsniffer/scam-database",name:"ScamSniffer",link:"https://scamsniffer.io/"},12:{id:"phishfort/phishfort-lists",name:"PhishFort",link:"https://www.phishfort.com/"},13:{id:"blueshell-io/scamdb",name:"BlueShell",link:"https://blueshell.io/"}};var B=R(require("cross-fetch"));function Ae(){return d(this,null,function*(){console.log("Compiling tokenlists");let t={1:"https://account.metafi.codefi.network/networks/1/tokens",10:"https://account.metafi.codefi.network/networks/10/tokens",137:"https://account.metafi.codefi.network/networks/137/tokens",51:"https://account.metafi.codefi.network/networks/56/tokens",43114:"https://account.metafi.codefi.network/networks/43114/tokens",42161:"https://account.metafi.codefi.network/networks/42161/tokens",250:"https://account.metafi.codefi.network/networks/250/tokens"},e=Object.keys(t).map(n=>(0,B.default)(t[n]).then(o=>o.json())),s=yield Promise.allSettled(e),a=[];for(let n=0;n<s.length;n++){let o=s[n];o.status=="fulfilled"&&(a=a.concat(o.value))}a.push({name:"Matic",symbol:"MATIC",decimals:18,address:"0x0000000000000000000000000000000000001010",iconUrl:"https://tokens.1inch.io/0x7d1afa7b718fb893db30a3abc0cfc608aacfebb0.png",sources:["https://wiki.polygon.technology/docs/faq/wallet-bridge-faq/#why-is-the-matic-token-is-not-supported-on-pos"],chainId:137,coingeckoId:"matic-network"});let i=yield(0,B.default)("https://raw.githubusercontent.com/MetaMask/contract-metadata/master/contract-map.json").then(n=>n.json());for(let[n,o]of Object.entries(i))a.push({name:o.name,symbol:o.symbol,decimals:o.decimals,address:n,iconUrl:"https://raw.githubusercontent.com/MetaMask/contract-metadata/master/images/"+o.logo,sources:["https://github.com/MetaMask/contract-metadata"],chainId:1});return console.log("\u{1FA99} ",a.length,"Tokens"),a})}u(Ae,"getTokenLists");var te=Ae;var w=(0,ae.default)({logger:!1}),Ee=require("ethereumjs-util").toBuffer,_e=require("eth-phishing-detect"),Ce=ue.default.promisify(require("child_process").exec);w.register(re.default,{global:!0});w.register(ne.default,{global:!0});w.register(oe.default,{origin:"*"});var Ie=require("megahash"),p=new Ie,A=new Set,Te=`https://api.tenderly.co/api/v1/account/${k("TENDERLY_USER")}/project/${k("TENDERLY_PROJECT")}/simulate`,Pe="socks5://0.0.0.0:9150",M=[],Me=new de.Convo(k("CONVO_API_KEY")),je={alchemyApiKey:k("ALCHEMY_API_KEY"),CNVSEC_ID:k("CNVSEC_ID"),etherscanApiKey:k("ETHERSCAN_API_KEY"),polygonscanApiKey:k("POLYGONSCAN_API_KEY"),optimismscanApiKey:k("OPTIMISMSCAN_API_KEY"),polygonMainnetRpc:"",etherumMainnetRpc:"",avalancheMainnetRpc:"",maticPriceInUsd:0,etherumPriceInUsd:0,deepdaoApiKey:"",zapperApiKey:"",DEBUG:!1},j=new Map([["mainnet","MAINNET_RPC_URL"],["mainnet-flashbots","MAINNET_FLASHBOTS_RPC_URL"],["mainnet-flashbots-fast","MAINNET_FLASHBOTS_FAST_RPC_URL"],["ropsten","ROPSTEN_RPC_URL"],["kovan","KOVAN_RPC_URL"],["rinkeby","RINKEBY_RPC_URL"],["goerli","GOERLI_RPC_URL"],["sepolia","SEPOLIA_RPC_URL"],["goerli-flashbots","GOERLI_FLASHBOTS_RPC_URL"],["polygon","POLYGON_RPC_URL"],["polygon-testnet","POLYGON_TESTNET_RPC_URL"],["polygon-zkevm","POLYGON_ZKEVM_RPC_URL"],["optimism","OPTIMISM_RPC_URL"],["optimism-testnet","OPTIMISM_TESTNET_RPC_URL"],["optimism-bedrock","OPTIMISM_BEDROCK_RPC_URL"],["arbitrum","ARBITRUM_RPC_URL"],["arbitrum-nova","ARBITRUM_NOVA_RPC_URL"],["arbitrum-testnet","ARBITRUM_TESTNET_RPC_URL"],["bsc","BSC_RPC_URL"],["bsc-testnet","BSC_TESTNET_RPC_URL"],["fantom","FANTOM_RPC_URL"],["fantom-testnet","FANTOM_TESTNET_RPC_URL"],["shardeum-testnet","SHARDEUM_TESTNET_RPC_URL"]]),Le=u(t=>{let e=j.get(t);if(e){let s=O(e);return s[Math.floor(Math.random()*s.length)]}else return""},"networkToRpc");function b(t,e=void 0){return{isMalicious:!0,rpcResp:{id:420,jsonrpc:"2.0",error:{code:-32003,message:t}},details:e}}u(b,"getMalRpcError");function $(t){return d(this,null,function*(){try{if((0,C.isAddress)(t)){let e=yield Me.omnid.kits.isMalicious((0,C.getAddress)(t),je);return console.log("omnid.kits.isMalicious",(0,C.getAddress)(t),e),(e==null?void 0:e.alchemy)&&e.alchemy===!0?b("Spam Contract Flagged by Alchemy",e):(e==null?void 0:e.chainabuse)&&Boolean(e.chainabuse)===!0?b("Contract Flagged by Chainabuse",e):(e==null?void 0:e.scanblocks)&&e.scanblocks===!0?b("Address Flagged by Scanblocks",e):(e==null?void 0:e.cryptoscamdb)&&e.cryptoscamdb===!0?b("Contract Flagged by CryptoscamDB",e):(e==null?void 0:e.etherscan)&&"label"in e.etherscan?b(`Address Flagged as ${e.etherscan.label} by Etherscan`,e):(e==null?void 0:e.mew)&&"comment"in e.mew?b("Address Flagged by MyEtherWallet",e):e!=null&&e.sdn?b("Address Flagged by OFAC",e):e!=null&&e.tokenblacklist?b("Address Blacklisted by Stablecoin",e):e!=null&&e.txn?b("Address/Contract Funded by Tornado Cash.",e):{isMalicious:!1}}else return{isMalicious:!1}}catch(e){return{isMalicious:!1}}})}u($,"checkAddress");function De(t){return d(this,null,function*(){try{return yield(0,h.default)(Te,{method:"POST",body:JSON.stringify(t),headers:{"X-Access-Key":k("TENDERLY_ACCESS_KEY")}}).then(s=>s.json())}catch(e){return console.log("alchemySimulate",e),!1}})}u(De,"alchemySimulate");function V(t,e,s=""){return d(this,null,function*(){let a=e.query;try{let i=t==="manual"?s===""?a.rpcUrl:s:Le(t);if(i!==void 0){let n={method:"POST",body:JSON.stringify(e.body),agent:(a==null?void 0:a.useTor)==="true"?new pe.SocksProxyAgent(Pe):null,headers:{"Content-Type":"application/json",Accept:"application/json","infura-source":"metamask/internal",origin:"chrome-extension://nkbihfbeogaeaoehlefnkodbefgpgknn"}};return console.log("reqOptions",n),yield(0,h.default)(i,n).then(m=>m.json())}else{let{rpcResp:n}=b("Invalid RPC Url");return n}}catch(i){let{rpcResp:n}=b(i);return n}})}u(V,"sendToRpc");function Ne(t,e){return d(this,null,function*(){let s=e.body,a=e.query;var i=Ee(s.params[0]),n=ce.FeeMarketEIP1559Transaction.fromSerializedTx(i),o=n.toJSON();if(console.log("deserializedTx",o),Object.keys(o).includes("to")===!0){let{isMalicious:l,rpcResp:c}=yield $(o.to);if(l==!0&&c)return c.id=s.id,c}let m=parseInt(o.maxFeePerGas||"0")+parseInt(n.maxPriorityFeePerGas.toString(10)||"0"),g={network_id:parseInt(n.chainId.toString(10)),from:n.getSenderAddress().toString(),to:n.to?n.to.toString():"",input:n.data.toString("hex"),gas:parseInt(n.gasLimit.toString(10)),gas_price:m.toString(10),value:parseInt(n.value.toString(10)),save_if_fails:!0,save:!1,simulation_type:"full"},f=yield De(g);if(f!=null&&f!=!1&&"transaction_info"in f&&f.transaction_info!=null){console.log("Sim Successful");for(let l=0;l<f.transaction_info.logs.length;l++){let c=f.transaction_info.logs[l];if(c.name==="Approval"||c.name==="Transfer"){let{isMalicious:y,rpcResp:_}=yield $(c.inputs[1].value);if(y===!0)return _}}}if(t!="manual"&&"blockUnverifiedContracts"in a&&a.blockUnverifiedContracts==="true"){let l=yield(0,h.default)(`https://sourcify.dev/server/check-all-by-addresses?addresses=${o==null?void 0:o.to}&chainIds=1,4,11155111,137,80001,10,42161,421611`),c;if(l.ok===!0){if(c=yield l.json(),Object.keys(c).includes("status")){let{rpcResp:y}=b("The contract is unverified");return y}}else{let{rpcResp:y}=b("Sourcify Request Failed");return y}}if(t in["mainnet","polygon","polygon-testnet"]&&(a==null?void 0:a.enableScanners)!==void 0&&o.to!==void 0){let l=t,c=a.enableScanners.split(",");for(let y=0;y<c.length;y++)if(c[y]==="slither"&&(yield U(l,o.to)).results.length>0)return b("Slither detected possible attack vectors")}if((a==null?void 0:a.blockRecentDnsUpdates)!=null&&Boolean(parseInt(a.blockRecentDnsUpdates))===!0){let l=parseInt(a.blockRecentDnsUpdates),c=yield(0,h.default)(`https://dns.google/resolve?name=${e.hostname}&type=SOA`);if(c.ok===!0){let y=yield c.json();if(y.Answer.length>0&&F(y.Answer[0].data)!=!1){let _=F(y.Answer[0].data);if(_!==!1&&(Date.now()-_.valueOf())/864e5<=l){let{rpcResp:K}=b("The domain's DNS has been changed recently.");return K}}}}return t==="mainnet"&&(a==null?void 0:a.useGasHawk)!=null&&a.useGasHawk==="true"?yield V("manual",e,"https://beta-be.gashawk.io:3001/proxy/rpc"):yield V(t,e)})}u(Ne,"processTxs");w.get("/",(t,e)=>d(exports,null,function*(){let s=(0,ie.readFileSync)(le.default.join(__dirname,"../public/","index.html"));return e.header("Content-Security-Policy","default-src *; style-src 'self' 'unsafe-inline' cdnjs.cloudflare.com; script-src 'self' 'unsafe-inline'; img-src data:;"),e.type("text/html").send(s)}));w.get("/ping",(t,e)=>d(exports,null,function*(){return e.send({hello:"world"})}));w.get("/blacklist",(t,e)=>d(exports,null,function*(){return e.headers({"Cache-Control":`max-age=${24*60*60}`}),e.send(p.stats())}));w.get("/whitelist",(t,e)=>d(exports,null,function*(){return e.headers({"Cache-Control":`max-age=${24*60*60}`}),e.send(Array.from(A.values()))}));w.get("/tor",(t,e)=>d(exports,null,function*(){try{let{stdout:s,stderr:a}=yield Ce("cat /var/lib/tor/hidden_service/hostname");return a==""?e.send({domain:s.replace(`
`,"")}):e.send({domain:!1,error:a})}catch(s){return e.send({domain:!1,error:s})}}));w.get("/blacklist/*",(t,e)=>d(exports,null,function*(){e.headers({"Cache-Control":`max-age=${24*60*60}`});let s=t.params,a=p.get(s["*"]);if(a===void 0)return e.send({blacklisted:!1});{let i=(0,L.closest)(s["*"],Array.from(A)),n=(0,L.distance)(s["*"],i);return e.send({blacklisted:!0,list:q[a],closestWhitelisted:{url:i,distance:n}})}}));w.get("/malicious/:ethAddress",(t,e)=>d(exports,null,function*(){e.headers({"Cache-Control":`max-age=${24*60*60}`});let s=t.params,a=yield $(s.ethAddress);return e.send(a)}));w.get("/tokendeets/:ethAddress",(t,e)=>d(exports,null,function*(){var i,n;e.headers({"Cache-Control":`max-age=${24*60*60}`});let s=t.params;Boolean(s==null?void 0:s.ethAddress)===!1&&e.send([]);let a=[];for(let o=0;o<M.length;o++)Boolean((i=M[o])==null?void 0:i.address)&&((n=M[o])==null?void 0:n.address.toLowerCase())===(s==null?void 0:s.ethAddress.toLowerCase())&&a.push(M[o]);return e.send(a)}));w.post("/lifejacket/:jacket",(t,e)=>d(exports,null,function*(){let s=["slither","mythril"],{jacket:a}=t.params;if(s.includes(a)){let{network:i,address:n}=t.body;if(i!=null&&n!=null&&(0,C.isAddress)(n)){if(a==="slither"){let o=yield U(i,n);return e.send(o)}}else return e.send({success:!1,error:"Invalid body params, network or address"})}else return e.send({success:!1,error:`Invalid LifeJacket, supported ${s.toString()}`})}));w.post("/:network",(t,e)=>d(exports,null,function*(){let{hostname:s}=t,a=t.body;if(!_e(s)&&Boolean(p.get(s))===!1){let{network:n}=t.params;if(console.log("req",n,a,t.query),n&&j.get(n))if(a.method=="eth_sendRawTransaction"){let o=yield Ne(n,t);return e.send(o)}else{let o=yield V(n,t);return e.send(o)}else return e.send({error:`Invalid network '${n}', available networks are ${Array.from(j.keys()).join(", ")}`})}else{let{rpcResp:n}=b(`\u{1F6A8} Phishing detector for the site ${s} has been triggered.`);return e.send(n)}}));w.addHook("preHandler",(t,e,s)=>{e.header("onion-location",`http://omnid2kq4qppsp2a5hgeqok6ahkfo23tdtoe7km4uier4o43taxct5ad.onion${t.url}`),s()});function ve(){return d(this,null,function*(){p.delete("instagram.com");let t=yield(0,h.default)("https://api.llama.fi/lite/protocols2").then(l=>l.json());t.protocols.forEach(l=>{try{let c=new URL(l.url.replace(`
`,"").replace("\r","")).hostname.replace("www.","");A.add(c),p.delete(c)}catch(c){}}),console.log("\u{1F7E2} DefiLlama Whitelist",t.protocols.length);let e=yield(0,h.default)("https://api2.thedapplist.com/api/v2/proposals/listed?offset=0&limit=1000000").then(l=>l.json()),s=0;Object.values(e.data.list).forEach(l=>{try{if(l.numberOfVotes>=5){let c=new URL(l.url).hostname.replace("www.","");A.add(c),p.delete(c),s+=1}}catch(c){}}),console.log("\u{1F7E2} Dapplist Whitelist",s);let a=yield(0,h.default)("https://gist.githubusercontent.com/anudit/8df081a368397dea5ff4ce8bdfac6256/raw/9d36d984fe3ed78bd1f993c4cca22ec4093d9253/index.json").then(l=>l.json()),i=0;Object.values(a.pageProps.defiList).forEach(l=>{try{let c=new URL(l.url).hostname.replace("www.","");A.add(c),p.delete(c),i+=1}catch(c){}}),console.log("\u{1F7E2} DefiPulse Whitelist",i);let n=yield(0,h.default)("https://dap.ps/metadata/all").then(l=>l.json()),o=0,m=Object.values(n);for(let l=0;l<m.length;l++)try{let c=m[l],y=new URL(c.details.url).hostname;A.add(y),p.delete(y),o+=1}catch(c){console.log(c);continue}console.log("\u{1F7E2} Dap.ps Whitelist",o);let g=yield(0,h.default)("https://gist.githubusercontent.com/anudit/a88c5888dcfb7b9cbf14a57d8eca61ad/raw/c9e02047a31989715249c9251e828fbab15d8140/links.json").then(l=>l.json()),f=0;g.forEach(l=>{try{let c=new URL(l.homepage).hostname.replace("www.","");A.add(c),p.delete(c),f+=1}catch(c){}}),console.log("\u{1F7E2} Walletconnect Whitelist",f)})}u(ve,"clearWhitelist");function se(){return d(this,null,function*(){let t=p.stats().numKeys;console.log("Compiling Blacklist");let e=[],s=u((r,S=0)=>{let N=p.stats().numKeys,G=N-t,he={Name:q[r].id,Length:S,"Unique Added":`${G.toLocaleString()} [+${(G/S*100).toFixed(2)}%]`,Total:N};return t=N,he},"logStat"),a=yield(0,h.default)("https://raw.githubusercontent.com/409H/EtherAddressLookup/master/blacklists/domains.json").then(r=>r.json());a.forEach(r=>{p.set(r,1)}),e.push(s(1,a.length));let i=yield(0,h.default)("https://raw.githubusercontent.com/MetaMask/eth-phishing-detect/master/src/config.json").then(r=>r.json());i.blacklist.forEach(r=>{p.set(r,2)}),e.push(s(2,i.blacklist.length));let n=yield(0,h.default)("https://raw.githubusercontent.com/MyEtherWallet/ethereum-lists/master/src/urls/urls-darklist.json").then(r=>r.json());n.forEach(r=>{p.set(r.id,3)}),e.push(s(3,n.length));let o=yield(0,h.default)("https://raw.githubusercontent.com/DAOBuidler/MetaShieldExtension/main/function/data/domain_blacklist.json").then(r=>r.json());o.forEach(r=>{let S=r.replace("'","").replace("http://","").replace("https://","");p.set(S,4)}),e.push(s(4,o.length));let m=yield(0,h.default)("https://api.cryptoscamdb.org/v1/blacklist").then(r=>r.json());m.result.forEach(r=>{p.set(r,5)}),e.push(s(5,m.result.length));let g=yield(0,h.default)("https://wallet-guard-server-prod.herokuapp.com/lists/all",{method:"GET",redirect:"follow",headers:{Origin:"chrome-extension://pdgbckgdncnhihllonhnjbdoighgpimk"}}),f=JSON.parse(yield g.text());f.blocklist.forEach(r=>{p.set(r,6)}),JSON.parse(f.whitelist).map(r=>r.extensions.map(S=>r.key+S)).flat().forEach(r=>{A.add(r),p.delete(r)}),e.push(s(6,f.blocklist.length));let y=yield(yield(0,h.default)("https://gist.githubusercontent.com/anudit/643a5a5a7b105a563836578fa6dfdbd1/raw/964215961af0bdce8e64a112da52a022f4679cf7/Chainabuse-ScamDomains.json")).json();y.forEach(r=>{p.set(r,7)}),e.push(s(7,y.length));let I=(yield(yield(0,h.default)("https://raw.githubusercontent.com/mitchellkrogza/Phishing.Database/master/phishing-domains-ACTIVE.txt")).text()).split(`
`);for(let r=0;r<I.length;r++)try{p.set(I[r],8)}catch(S){continue}e.push(s(8,I.length));let Y=yield yield(0,h.default)("https://phish.sinking.yachts/v2/all").then(r=>r.json());Y.forEach(r=>{p.set(r,9)}),e.push(s(9,Y.length));let D=(yield(yield(0,h.default)("https://raw.githubusercontent.com/stamparm/aux/master/maltrail-malware-domains.txt")).text()).split(`
`);for(let r=0;r<D.length;r++)try{p.set(D[r],10)}catch(S){continue}e.push(s(10,D.length));let H=yield(0,h.default)("https://raw.githubusercontent.com/scamsniffer/scam-database/main/blacklist/domains.json").then(r=>r.json());H.forEach(r=>{p.set(r,11)}),e.push(s(11,H.length));let J=yield(0,h.default)("https://raw.githubusercontent.com/phishfort/phishfort-lists/master/blacklists/domains.json").then(r=>r.json());J.forEach(r=>{p.set(r,12)}),e.push(s(12,J.length));let W=(yield(0,h.default)("https://raw.githubusercontent.com/blueshell-io/scamdb/bec21924d47b3391196b7bb701316a75a3ac6009/website.json").then(r=>r.json())).data.map(r=>r.scams).flat().filter(r=>r!=null).map(r=>r.url).filter(r=>r!="");W.forEach(r=>{try{let S=new URL(r).hostname;p.set(S,13)}catch(S){}}),e.push(s(13,W.length)),console.table(e),yield ve()})}u(se,"compileBlacklist");function Oe(){return d(this,null,function*(){M=yield te();let t=[],e=u((s,a=0)=>({Network:s,"RPC Set":a}),"logStat");j.forEach((s,a)=>{t.push(e(a,O(s).length))}),console.table(t)})}u(Oe,"rpcSet");w.listen({port:parseInt(k("PORT"))||80,host:"0.0.0.0"},(t,e)=>{if(Oe(),se(),setInterval(se,60*60*1e3),!t)console.log("\u{1F680} Server is listening on",e);else throw t});
